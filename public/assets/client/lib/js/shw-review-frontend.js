jQuery(document).ready(function (e) {
    "use strict"; ({
        init() { e("#shw-review-image").on("change", (e) => this.AddImageChange(e)), e(".shw-upload-images-preview").on("click", ".shw-upload-images-delete", (e) => this.DeleteImageUploaded(e)), e("form#commentform").submit((e) => this.PreventDefaultSubmitForm(e)); e('.comment-form-rating .stars a[class*="star-"]').on("mouseover", function () { var onStar = e(this).index() + 1; e(this).parent().children('a[class*="star-"]').each(function (ev) { if (ev < onStar) { e(this).addClass("hover") } else { e(this).removeClass("hover") } }) }).on("mouseout", function () { e(this).parent().children('a[class*="star-"]').each(function (ev) { e(this).removeClass("hover") }) }); e('.comment-form-rating .stars a[class*="star-"]').on("click", function () { var onStar = e(this).index() + 1; var stars = e(this).parent().children('a[class*="star-"]'); e(this).parent().children('a[class*="star-"]').removeClass("selected"); let i = 0; for (i = 0; i < onStar; i++) { e(stars[i]).addClass("selected") } }) }, PreventDefaultSubmitForm(a) {
            if ("" === e.trim(e("form#commentform #comment").val()))
                return alert("Vui lÃ²ng nháº­p ná»™i dung Ä‘Ã¡nh giÃ¡"), a.preventDefault(), !1
        }, AddImageChange(a) {
            let s = e(a.currentTarget); e(".shw-upload-images-status").removeClass("shw-upload-images-status-error"), e(".shw-upload-images-status").text(shwObjectReviews.shw_upload_initial); let t = ["image/jpeg", "image/png", "image/jpg", "image/gif"], o = e("#shw-review-image"), i = o[0].files.length, r = e(".shw-upload-images-preview .shw-upload-images-containers").length, d = 1; if ((s.attr("data-lastindex") && (d = parseInt(s.attr("data-lastindex"))), i + r > shwObjectReviews.shw_images_upload_limit))
                return (e(".shw-upload-images-status").addClass("shw-upload-images-status-error"), e(".shw-upload-images-status").text(shwObjectReviews.shw_upload_error_too_many), e(".shw-upload-images-preview .shw-upload-images-containers").not(".shw-upload-ok").remove(), void o.val("")); for (let a = 0; a < i; a++) {
                    if (!t.includes(o[0].files[a].type))
                        return (e(".shw-upload-images-status").addClass("shw-upload-images-status-error"), e(".shw-upload-images-status").text(shwObjectReviews.shw_upload_error_file_type), e(".shw-upload-images-preview .shw-upload-images-containers").not(".shw-upload-ok").remove(), void o.val("")); if (o[0].files[a].size && o[0].files[a].size > shwObjectReviews.shw_images_upload_max_size)
                        return (e(".shw-upload-images-status").addClass("shw-upload-images-status-error"), e(".shw-upload-images-status").text(shwObjectReviews.shw_upload_error_file_size), e(".shw-upload-images-preview .shw-upload-images-containers").not(".shw-upload-ok").remove(), void o.val("")); { let s = e("<div/>", { class: "shw-upload-images-containers shw-upload-images-container-" + (d + a), }); s.data("data-index", d + a); let t = e("<div/>", { class: "shw-upload-images-pbar" }); t.append(e("<div/>", { class: "shw-upload-images-pbarin" })), s.append(e("<img>", { class: "shw-upload-images-thumbnail", src: URL.createObjectURL(o[0].files[a]), })), s.append(t); let i = e("<a/>", { class: "shw-upload-images-delete" }); i.append('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><rect x="0" fill="none" width="20" height="20"/><g><path class="shw-no-icon" d="M12.12 10l3.53 3.53-2.12 2.12L10 12.12l-3.54 3.54-2.12-2.12L7.88 10 4.34 6.46l2.12-2.12L10 7.88l3.54-3.53 2.12 2.12z"/></g></svg>'), s.append(i), s.append(e("<input>", { name: "shw-upload-images-ids[]", type: "hidden", value: "", })), e(".shw-upload-images-preview").append(s) }
                }
            for (let a = 0; a < i; a++) { let t = new FormData(); t.append("action", "shw_upload_images_frontend"), t.append("post_id", s.attr("data-postid")), t.append("shw_nonce", s.attr("data-nonce")), t.append("shw_postid", s.attr("data-postid")), t.append("shw_file", o[0].files[a]), e.ajax({ type: "POST", url: shwObjectReviews.ajaxUrl, data: t, processData: !1, contentType: !1, beforeSend: function () { e("#commentform .form-submit #submit").attr("disabled", "disabled"), e("#commentform .form-submit #submit").addClass("loading") }, xhr: function () { var s = e.ajaxSettings.xhr(); return (s.upload && s.upload.addEventListener("progress", function (s) { if (s.lengthComputable) { let t = (s.loaded / s.total) * 100; (t = t.toFixed(0)), e(".shw-upload-images-preview .shw-upload-images-containers.shw-upload-images-container-" + (d + a) + " .shw-upload-images-pbar .shw-upload-images-pbarin").width(t + "%") } }, !1), s) }, success: function (s) { if (200 === s.code) { console.log(s); let t = JSON.stringify({ id: s.attachment.id, key: s.attachment.key, }); e(".shw-upload-images-preview .shw-upload-images-containers.shw-upload-images-container-" + (d + a) + " input").val(t), e(".shw-upload-images-preview .shw-upload-images-containers.shw-upload-images-container-" + (d + a)).addClass("shw-upload-ok"), e(".shw-upload-images-preview .shw-upload-images-containers.shw-upload-images-container-" + (d + a)).removeClass("loading"), e(".shw-upload-images-preview .shw-upload-images-containers.shw-upload-images-container-" + (d + a) + " a").data("delnonce", s.attachment.nonce) } else 500 <= s.code && (e(".shw-upload-images-preview .shw-upload-images-containers.shw-upload-images-container-" + (d + a)).remove(), e(".shw-upload-images-status").addClass("shw-upload-images-status-error"), e(".shw-upload-images-status").text(s.message)); e("#commentform .form-submit #submit").removeAttr("disabled"), e("#commentform .form-submit #submit").removeClass("loading") }, error: function (s, t) { var o = ""; (o = 400 === s.status || 0 === s.status ? "Not connect.\n Verify Network." : 404 == s.status ? "Requested page not found. [404]" : 500 == s.status ? "Internal Server Error [500]." : "parsererror" === t ? "Requested JSON parse failed." : "timeout" === t ? "Time out error." : "abort" === t ? "Ajax request aborted." : "Uncaught Error.\n" + s.responseText), e(".shw-upload-images-status").addClass("shw-upload-images-status-error"), e(".shw-upload-images-status").text(o), e(".shw-upload-images-preview .shw-upload-images-containers.shw-upload-images-container-" + (d + a)).remove(), e("#commentform .form-submit #submit").removeAttr("disabled"), e("#commentform .form-submit #submit").removeClass("loading") }, }) }
            s.attr("data-lastindex", d + i), o.val("")
        }, DeleteImageUploaded(a) { a.preventDefault(), e(".shw-upload-images-status").removeClass("shw-upload-images-status-error"); let s = e(a.currentTarget).parent(), t = { action: "shw_delete_images_frontend", shw_nonce: e(a.currentTarget).data("delnonce"), image: s.children("input").eq(0).val(), }; s.addClass("loading"), e("#commentform .form-submit #submit").attr("disabled", "disabled"), e("#commentform .form-submit #submit").addClass("loading"), e.post(shwObjectReviews.ajaxUrl, t, function (a) { 200 === a.code && s.remove(), s.removeClass("loading"), e("#commentform .form-submit #submit").removeAttr("disabled"), e("#commentform .form-submit #submit").removeClass("loading") }, "json") },
    }.init())
})
